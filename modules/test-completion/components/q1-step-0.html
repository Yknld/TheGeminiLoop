<div class="module-container" style="
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f0f8ff;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    padding: 20px;
    max-width: 100%;
    width: 100%;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px; /* Spacing between elements */
    min-height: 220px; /* Ensure reasonable height for content and new elements */
    justify-content: center;
">
    <style>
        .module-container p {
            margin: 0;
            padding: 0;
            color: #2563eb;
            font-size: 1.2em;
            font-weight: 600;
            text-align: center;
        }
        .module-container .instruction-text {
            color: #333; /* Darker color for instructions */
            font-size: 1em;
            font-weight: 400;
            margin-bottom: 10px; /* Spacing between instruction and starting quantity */
        }
        .circle-group {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px; /* Small gap between individual circles */
            flex-wrap: wrap; /* Allows wrapping if the container is too narrow */
            margin-top: 10px; /* Space between Starting Quantity text and circles */
            margin-bottom: 15px; /* Space between circles and feedback */
        }
        .circle {
            width: 45px;
            height: 45px;
            background-color: #3b82f6; /* Specified blue color */
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: background-color 0.2s ease, opacity 0.2s ease, transform 0.2s ease;
            cursor: pointer; /* Indicate interactivity */
        }
        .circle:hover:not(.removed) {
            background-color: #6ea8ff; /* Lighter blue on hover */
            transform: scale(1.05); /* Slight scale up on hover */
        }
        .circle.removed {
            background-color: #ccc; /* Greyed out when removed */
            opacity: 0.5;
            cursor: default; /* Not clickable once removed */
            box-shadow: none; /* Removed circles don't cast shadow */
        }
        .feedback-text {
            color: #007bff;
            font-size: 1em;
            font-weight: 500;
            text-align: center;
            margin-top: 5px;
        }
        .success-message {
            color: #28a745;
            font-weight: 700;
            margin-top: 10px;
        }
    </style>

    <div class="instruction-text">
        <p>Subtract 3 from the starting quantity.</p>
        <p>Click on 3 circles to remove them.</p>
    </div>

    <p id="startingQuantityDisplay">Starting Quantity: 7</p>

    <div class="circle-group" id="circleGroup">
        <!-- Circles will be dynamically generated by JavaScript -->
    </div>

    <div class="feedback-text">
        <span id="removedCountDisplay">Removed: 0</span> | <span id="remainingQuantityDisplay">Remaining: 7</span>
    </div>
    <div class="feedback-text success-message" id="completionMessage" style="display: none;">
        Great! You have subtracted 3. The difference is 4.
    </div>

    <script>
        (function() {
            const initialQuantity = 7;
            const targetSubtraction = 3;
            let removedCount = 0;
            let currentQuantity = initialQuantity;

            const circleGroup = document.getElementById('circleGroup');
            const removedCountDisplay = document.getElementById('removedCountDisplay');
            const remainingQuantityDisplay = document.getElementById('remainingQuantityDisplay');
            const completionMessage = document.getElementById('completionMessage');

            // Function to render circles dynamically
            function renderCircles() {
                circleGroup.innerHTML = ''; // Clear existing circles
                for (let i = 0; i < initialQuantity; i++) {
                    const circle = document.createElement('div');
                    circle.classList.add('circle');
                    circle.dataset.index = i; // Assign a unique index to each circle
                    circleGroup.appendChild(circle);
                }
                attachCircleListeners();
                updateDisplays();
            }

            // Function to attach event listeners to newly created circles
            function attachCircleListeners() {
                const circles = circleGroup.querySelectorAll('.circle');
                circles.forEach(circle => {
                    circle.addEventListener('click', function() {
                        // Only allow interaction if the circle hasn't been removed and the target hasn't been met
                        if (!this.classList.contains('removed') && removedCount < targetSubtraction) {
                            this.classList.add('removed'); // Mark circle as removed
                            removedCount++; // Increment removed count
                            currentQuantity--; // Decrement current quantity
                            updateDisplays(); // Update feedback

                            if (removedCount === targetSubtraction) {
                                completionMessage.style.display = 'block'; // Show completion message
                            }
                        }
                    });
                });
            }

            // Function to update the feedback displays (removed count and remaining quantity)
            function updateDisplays() {
                removedCountDisplay.textContent = `Removed: ${removedCount}`;
                remainingQuantityDisplay.textContent = `Remaining: ${currentQuantity}`;
            }

            // Initial rendering of circles and setting up the display
            renderCircles();
        })();
    </script>
</div>
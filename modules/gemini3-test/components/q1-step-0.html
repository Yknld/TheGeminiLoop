<div class="module-container" style="font-family: system-ui, -apple-system, sans-serif; max-width: 100%; margin: 0 auto; padding: 20px; background: #f8fafc; border-radius: 12px; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); border: 1px solid #e2e8f0; display: flex; flex-direction: column; align-items: center; gap: 15px; overflow: hidden;">
    <style>
        .coin-scene {
            width: 160px;
            height: 160px;
            perspective: 600px;
            margin: 10px 0;
            cursor: grab;
        }
        .coin-scene:active { cursor: grabbing; }
        
        .coin {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.1s ease-out;
        }
        
        .coin-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 6px solid #d4af37;
            background: linear-gradient(135deg, #ffd700, #b8860b);
            box-shadow: inset 0 0 15px rgba(0,0,0,0.2);
        }
        
        .coin-face.tails {
            transform: rotateY(180deg);
            background: linear-gradient(135deg, #e5e7eb, #9ca3af);
            border-color: #6b7280;
        }

        .sample-space-box {
            width: 100%;
            background: white;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .sample-space-header {
            font-size: 0.85rem;
            font-weight: 700;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 4px;
        }

        .outcome-list {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .outcome-item {
            flex: 1;
            padding: 8px;
            text-align: center;
            border-radius: 6px;
            font-weight: 600;
            border: 2px solid #f1f5f9;
            transition: all 0.2s ease;
            color: #94a3b8;
        }

        .outcome-item.active-heads {
            background: #fef9c3;
            border-color: #eab308;
            color: #854d0e;
            transform: scale(1.05);
        }

        .outcome-item.active-tails {
            background: #f1f5f9;
            border-color: #64748b;
            color: #1e293b;
            transform: scale(1.05);
        }

        input[type=range] {
            width: 100%;
            cursor: pointer;
            accent-color: #2563eb;
        }

        .label-text {
            font-size: 14px;
            font-weight: 800;
            margin-top: 5px;
        }
        
        svg { width: 60px; height: 60px; }
    </style>

    <div class="sample-space-box">
        <div class="sample-space-header">Sample Space</div>
        <div class="outcome-list">
            <div id="outcome-heads" class="outcome-item">Heads (H)</div>
            <div id="outcome-tails" class="outcome-item">Tails (T)</div>
        </div>
    </div>

    <div class="coin-scene" id="coin-scene">
        <div class="coin" id="coin-object">
            <!-- Heads Face -->
            <div class="coin-face heads">
                <svg viewBox="0 0 24 24" fill="none" stroke="#854d0e" stroke-width="2">
                    <path d="M12 2a5 5 0 0 0-5 5v3a5 5 0 0 0 10 0V7a5 5 0 0 0-5-5z"/>
                    <path d="M17 14c-1.5-1-3.5-1.5-5-1.5s-3.5.5-5 1.5c-1.2.8-2 2.1-2 3.5v1h14v-1c0-1.4-.8-2.7-2-3.5z"/>
                </svg>
                <div class="label-text" style="color: #854d0e;">HEADS</div>
            </div>
            <!-- Tails Face -->
            <div class="coin-face tails">
                <svg viewBox="0 0 24 24" fill="none" stroke="#374151" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 8v8M8 12h8"/>
                </svg>
                <div class="label-text" style="color: #374151;">TAILS</div>
            </div>
        </div>
    </div>

    <div style="width: 100%; display: flex; flex-direction: column; gap: 5px;">
        <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: #64748b; font-weight: 600;">
            <span>Rotate Coin</span>
            <span id="angle-display">0°</span>
        </div>
        <input type="range" id="rotate-slider" min="0" max="360" value="0">
    </div>

    <script>
        (function() {
            const coin = document.getElementById('coin-object');
            const slider = document.getElementById('rotate-slider');
            const angleDisplay = document.getElementById('angle-display');
            const headsIndicator = document.getElementById('outcome-heads');
            const tailsIndicator = document.getElementById('outcome-tails');

            function updateRotation(deg) {
                // Normalize degree for display
                const normalizedDeg = deg % 360;
                coin.style.transform = `rotateY(${deg}deg)`;
                angleDisplay.textContent = `${normalizedDeg}°`;

                // Logic to determine which side is facing user
                // rotateY 0 is heads, 180 is tails. 
                // Heads is visible when normalized degree is 0-90 or 270-360
                // Tails is visible when normalized degree is 90-270
                const isTailsVisible = normalizedDeg > 90 && normalizedDeg < 270;

                if (isTailsVisible) {
                    tailsIndicator.classList.add('active-tails');
                    headsIndicator.classList.remove('active-heads');
                } else {
                    headsIndicator.classList.add('active-heads');
                    tailsIndicator.classList.remove('active-tails');
                }
            }

            slider.oninput = (e) => {
                updateRotation(parseInt(e.target.value));
            };

            // Initialize
            updateRotation(0);

            // Optional Mouse Interaction
            let isDragging = false;
            let startX;
            let currentAngle = 0;

            const scene = document.getElementById('coin-scene');
            
            scene.addEventListener('mousedown', (e) => {
                isDragging = true;
                startX = e.pageX;
            });

            window.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                const dx = e.pageX - startX;
                const newAngle = (currentAngle + dx) % 360;
                const posAngle = newAngle < 0 ? 360 + newAngle : newAngle;
                slider.value = posAngle;
                updateRotation(posAngle);
            });

            window.addEventListener('mouseup', () => {
                if (isDragging) {
                    isDragging = false;
                    currentAngle = parseInt(slider.value);
                }
            });

            // Touch support
            scene.addEventListener('touchstart', (e) => {
                isDragging = true;
                startX = e.touches[0].pageX;
            });

            window.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                const dx = e.touches[0].pageX - startX;
                const newAngle = (currentAngle + dx) % 360;
                const posAngle = newAngle < 0 ? 360 + newAngle : newAngle;
                slider.value = posAngle;
                updateRotation(posAngle);
            });

            window.addEventListener('touchend', () => {
                if (isDragging) {
                    isDragging = false;
                    currentAngle = parseInt(slider.value);
                }
            });
        })();
    </script>
</div>